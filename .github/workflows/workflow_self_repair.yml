name: GD-A Workflow Self-Repair

on:
  workflow_dispatch:

jobs:
  audit_workflows:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Install PyYAML
        run: pip install pyyaml

      - name: Audit yaml workflows
        run: |
          echo "[GDA REPAIR] Lancement audit des fichiers workflows"
          mkdir -p logs/
          
          for file in .github/workflows/*.yml; do
            echo "- Test : $file"
            if python3 -c "import yaml; yaml.safe_load(open('$file'))" 2>/dev/null; then
              echo "[OK] : $(basename $file)"
            else
              echo "[FAILED] : Fichier mal structur√© : $(basename $file)"
            fi
          done
          
          echo "[GDA REPAIR FIN]"
